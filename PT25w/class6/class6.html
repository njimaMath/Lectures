<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>二項分布と中心極限定理</title>
  <!-- Base Styles -->
  <style>
    :root {
      --primary: #1a237e;
      --surface: rgba(255, 255, 255, 0.92);
      --surface-strong: rgba(247, 248, 255, 0.94);
      --border: rgba(26, 35, 126, 0.12);
      --shadow: 0 22px 48px -32px rgba(26, 35, 126, 0.35);
    }
    html {
      box-sizing: border-box;
    }
    *, *::before, *::after {
      box-sizing: inherit;
    }
    body {
      margin: 0;
      font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
      line-height: 1.8;
      color: #1f2230;
      background:
        radial-gradient(circle at 20% 20%, rgba(63, 81, 181, 0.16), transparent 55%),
        radial-gradient(circle at 80% 0%, rgba(26, 35, 126, 0.12), transparent 55%),
        linear-gradient(180deg, #f6f7ff 0%, #fafafa 60%, #f1f3ff 100%);
    }
    .container {
      max-width: 960px;
      margin: 0 auto;
      padding: 2.5rem 1.2rem 4rem;
      background: var(--surface);
      border-radius: 20px;
      box-shadow: 0 22px 60px -35px rgba(33, 33, 33, 0.45);
      backdrop-filter: blur(6px);
    }
    header h1 {
      margin: 0 0 1.6rem;
      font-size: clamp(1.9rem, 2.6vw, 2.3rem);
      text-align: center;
      color: var(--primary);
      letter-spacing: 0.05em;
    }
    main {
      display: grid;
      gap: 2.6rem;
      padding: 0.5rem 0 0;
    }
    h2 {
      font-size: 1.55rem;
      color: var(--primary);
      letter-spacing: 0.02em;
    }
    h3 {
      font-size: 1.2rem;
      margin: 0;
      color: var(--primary);
    }
    .topic {
      background: linear-gradient(135deg, rgba(26, 35, 126, 0.1) 0%, rgba(26, 35, 126, 0) 65%);
      border-radius: 22px;
      border: 1px solid var(--border);
      box-shadow: var(--shadow);
      overflow: hidden;
      position: relative;
    }
    .topic > h2 {
      margin: 0;
      padding: 1.15rem 1.6rem;
      background: rgba(255, 255, 255, 0.88);
      border-bottom: 1px solid rgba(26, 35, 126, 0.14);
    }
    .section-body {
      padding: 1.9rem 1.7rem 2.1rem;
      display: grid;
      gap: 1.5rem;
      background: var(--surface-strong);
    }
    .section-body article {
      background: rgba(255, 255, 255, 0.9);
      border: 1px solid rgba(63, 81, 181, 0.14);
      border-radius: 16px;
      padding: 1.25rem 1.4rem;
      display: grid;
      gap: 0.95rem;
      box-shadow: 0 16px 30px -28px rgba(63, 81, 181, 0.6);
    }
    .section-body article.theorem {
      border-left: 6px solid #3949ab;
      background: linear-gradient(135deg, rgba(63, 81, 181, 0.22) 0%, rgba(255, 255, 255, 0.9) 55%);
      box-shadow: 0 18px 34px -30px rgba(39, 67, 170, 0.75);
    }
    .section-body article.example {
      border-left: 6px solid #43a047;
      background: linear-gradient(135deg, rgba(76, 175, 80, 0.18) 0%, rgba(255, 255, 255, 0.9) 55%);
    }
    .section-body article.theorem h3 {
      font-size: 1.2rem;
      margin-bottom: 0.2rem;
    }
    .section-body p {
      margin: 0;
    }
    .section-body p + p {
      margin-top: 0.9rem;
    }
    .formula {
      background: rgba(63, 81, 181, 0.08);
      border-left: 4px solid #5c6bc0;
      padding: 0.85rem 1.2rem;
      border-radius: 10px;
      overflow-x: auto;
      font-size: 1.03rem;
      box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.7);
    }
    .note {
      background: rgba(255, 193, 7, 0.1);
      border-left: 4px solid #ffa000;
      padding: 0.85rem 1.2rem;
      border-radius: 10px;
    }
    ul, ol {
      margin: 0;
      padding-left: 1.4rem;
      display: grid;
      gap: 0.6rem;
    }
    details {
      background: rgba(63, 81, 181, 0.05);
      border-radius: 12px;
      padding: 1rem 1.2rem;
      margin: 1rem 0;
    }
    details summary {
      cursor: pointer;
      font-weight: 600;
      color: var(--primary);
    }
    details[open] summary {
      margin-bottom: 0.8rem;
    }
    nav.navigation {
      display: flex;
      justify-content: center;
      gap: 0.9rem;
      margin: 2.8rem 0;
      padding-top: 1.8rem;
      border-top: 1px solid rgba(26, 35, 126, 0.15);
      flex-wrap: wrap;
    }
    nav.navigation a {
      padding: 0.7rem 1.6rem;
      background: var(--primary);
      color: #fff;
      text-decoration: none;
      border-radius: 999px;
      box-shadow: 0 14px 28px -18px rgba(26, 35, 126, 0.58);
      transition: transform 0.2s, box-shadow 0.2s, opacity 0.2s;
    }
    nav.navigation a:hover {
      opacity: 0.9;
      transform: translateY(-2px);
      box-shadow: 0 18px 32px -22px rgba(26, 35, 126, 0.62);
    }
    footer {
      margin-top: 3rem;
      font-size: 0.9rem;
      color: #646b8a;
      text-align: center;
    }
    code {
      background: #eceff1;
      padding: 2px 4px;
      border-radius: 4px;
    }
    @media (max-width: 720px) {
      .container {
        padding: 1.8rem 1rem 3rem;
        border-radius: 16px;
      }
      .topic > h2 {
        padding: 1rem 1.2rem;
      }
      .section-body {
        padding: 1.4rem 1.2rem 1.6rem;
      }
      nav.navigation {
        gap: 0.6rem;
      }
      nav.navigation a {
        padding: 0.6rem 1.3rem;
      }
    }
  </style>
  <!-- MathJax -->
  <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$']],
        displayMath: [['$$', '$$']]
      },
      chtml: { matchFontHeight: false }
    };
  </script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
  <div class="container">
    <header>
      <h1 id="top">二項分布と中心極限定理</h1>
    </header>

    <main role="main">
      <!-- ********** 二項分布モデル ********** -->
      <section class="topic" id="binomial-model">
        <h2>二項分布モデル</h2>
        <div class="section-body">
          <article>
            <p>
              $X_1,\dots,X_n$ を独立なベルヌーイ($p$)確率変数とする。つまり $\mathbb P(X_i=1)=p$ かつ $\mathbb P(X_i=0)=1-p=:q$ である。
              成功回数の和を次のように定義する:
            </p>
            <div class="formula">$$S_n:=X_1+\cdots+X_n$$</div>
            <p>このとき $S_n$ は二項分布に従う:</p>
            <div class="formula">$$\mathbb P(S_n=k)=\binom{n}{k}p^{k}q^{n-k}\quad(k=0,1,\dots,n)$$</div>
            <p>期待値と分散は線形性と独立性から得られる:</p>
            <div class="formula">$$\mathbb E[S_n]=np,\qquad \operatorname{Var}(S_n)=npq$$</div>
          </article>

          <article>
            <h3>形状の直感</h3>
            <p>
              $\mathbb P(S_n=k)$ のヒストグラムは $np$ を中心とし、$p=\tfrac12$ のとき対称である。
              標準偏差が $\sqrt{npq}$ であるため $n$ が大きくなるにつれて集中する。
            </p>
          </article>
        </div>
      </section>

      <!-- ********** スターリングの公式 ********** -->
      <section class="topic" id="stirling">
        <h2>スターリングの公式</h2>
        <div class="section-body">
          <article>
            <p>階乗の大きな $n$ での近似:</p>
            <div class="formula">$$n!\sim \sqrt{2\pi n}\,\left(\frac{n}{e}\right)^n$$</div>
            <p>対数形式では:</p>
            <div class="formula">$$\log n!=n\log n-n+\tfrac12\log(2\pi n)+o(1)$$</div>
            <p>
              主要項 $n\log n-n$ と $\sqrt{2\pi n}$ の因子を覚えておく。この定数 $\sqrt{2\pi}$ が正規分布の密度関数にも現れる。
            </p>
          </article>
        </div>
      </section>

      <!-- ********** 局所正規近似 ********** -->
      <section class="topic" id="local-approximation">
        <h2>局所ド・モアブル–ラプラス近似</h2>
        <div class="section-body">
          <article class="theorem">
            <h3>定理(局所近似)</h3>
            <p>$q=1-p$ とし、$\sigma^2:=npq$ とおく。$\sqrt{n}$ のスケールで $np$ に近い $k$ について:</p>
            <div class="formula">$$k = np + x\,\sqrt{npq}\quad\text{(ただし }x=O(1)\text{)}$$</div>
            <p>とすると、次の近似が成り立つ:</p>
            <div class="formula">$$\mathbb P(S_n=k)\approx\frac{1}{\sqrt{2\pi\,npq}}\,\exp\left(-\frac{(k-np)^2}{2\,npq}\right)$$</div>
          </article>

          <article>
            <h3>証明の概略</h3>
            <p>二項分布の質量関数の対数をとり、スターリング展開を適用する:</p>
            <div class="formula">$$\log \mathbb P(S_n=k)= \log n! - \log k! - \log(n-k)! + k\log p + (n-k)\log q$$</div>
            <p>$t:=k/n$ とおき、関数</p>
            <div class="formula">$$G(t) := -t\log\left(\frac{t}{p}\right) -(1-t)\log\left(\frac{1-t}{q}\right)$$</div>
            <p>を定義すると、スターリング展開により</p>
            <div class="formula">$$\log \mathbb P(S_n=k)= n\,G(t)+\tfrac12\log\left(\frac{1}{2\pi n\,t(1-t)}\right)+o(1)$$</div>
            <p>$t=p$ の周りでテイラー展開すると:</p>
            <div class="formula">$$G(p)=0,\quad G'(p)=0,\quad G''(p)=-\frac{1}{pq}$$</div>
            <p>したがって $t=p+x\sqrt{pq/n}$ に対して</p>
            <div class="formula">$$n\,G(t) = -\,\frac{x^2}{2} + o(1)$$</div>
            <p>また $t(1-t)=pq+o(1)$ より、指数をとって定理の式が得られる。$\square$</p>
          </article>

          <article class="example">
            <h3>数値例</h3>
            <p>$n=100$, $p=q=\tfrac12$ に対して中心点 $k=50$ での確率:</p>
            <div class="formula">$$\mathbb P(S_{100}=50)\approx \frac{1}{\sqrt{2\pi\cdot 100\cdot 1/4}}=\frac{1}{\sqrt{50\pi}}\approx 0.0798$$</div>
            <p>厳密な値 $\binom{100}{50}/2^{100}\approx 0.0796$ と非常に近い。</p>
          </article>
        </div>
      </section>

      <!-- ********** 中心極限定理 ********** -->
      <section class="topic" id="clt">
        <h2>中心極限定理への拡張</h2>
        <div class="section-body">
          <article>
            <h3>標準化</h3>
            <p>標準化された和を定義する:</p>
            <div class="formula">$$Z_n := \frac{S_n-np}{\sqrt{npq}}$$</div>
            <p>$Z_n$ がとる値は格子 $x_k = \frac{k-np}{\sqrt{npq}}$ を形成し、その間隔は $\Delta x=\frac{1}{\sqrt{npq}}$ である。</p>
          </article>

          <article>
            <h3>リーマン和による議論</h3>
            <p>局所近似は次のように書き換えられる:</p>
            <div class="formula">$$\mathbb P(Z_n=x_k)\approx \varphi(x_k)\,\Delta x,\qquad \varphi(x)=\frac{1}{\sqrt{2\pi}}e^{-x^2/2}$$</div>
            <p>分布関数を近似するには質量を和する:</p>
            <div class="formula">$$\mathbb P(Z_n\le t)=\sum_{x_k\le t}\mathbb P(Z_n=x_k)\approx \sum_{x_k\le t}\varphi(x_k)\,\Delta x$$</div>
            <p>右辺は $\int_{-\infty}^{t}\varphi(x)\,dx=\Phi(t)$ のリーマン和である。</p>
          </article>

          <article class="theorem">
            <h3>定理(ド・モアブル–ラプラス)</h3>
            <p>次の収束が成り立つ:</p>
            <div class="formula">$$\boxed{\mathbb P\left(\frac{S_n-np}{\sqrt{npq}}\le t\right)\longrightarrow \Phi(t)\quad (n\to\infty)}$$</div>
            <p>ここで $\Phi(t)=\int_{-\infty}^t \frac{1}{\sqrt{2\pi}}e^{-x^2/2}\,dx$ は標準正規分布の分布関数である。</p>
          </article>

          <article>
            <h3>正当化</h3>
            <ul>
              <li><strong>中心領域:</strong> 固定された $R>0$ に対し、$|x_k|\le R$ で近似が一様に成り立つ(局所定理)。</li>
              <li><strong>裾:</strong> チェビシェフの不等式により $\mathbb P(|Z_n|>R)\le R^{-2}$ なので、$R$ を大きくとれば裾は無視できる。</li>
            </ul>
          </article>
        </div>
      </section>
      <!-- ********** まとめ ********** -->

      <!-- ********** レポート課題 ********** -->
      <section class="topic" id="report">
        <h2>レポート課題</h2>
        <div class="section-body">
          <article>
            <h3>課題: サイコロ投げのシミュレーションと正規近似の検証</h3>
            <p>
              公正なサイコロを $n$ 回投げたとき、出た目の合計 $S_n$ の分布を調べる。
              各回の出目を $X_i$ とすると、$X_i$ は $\{1,2,3,4,5,6\}$ 上の一様分布に従う独立な確率変数である。
            </p>
            
            <h3>課題内容</h3>
            <ol>
              <li><strong>理論計算:</strong>
                <ul>
                  <li>$X_i$ の期待値 $\mathbb E[X_i]$ と分散 $\operatorname{Var}(X_i)$ を計算せよ。</li>
                  <li>$S_n = X_1 + \cdots + X_n$ の期待値と分散を求めよ。</li>
                  <li>中心極限定理により、標準化された $\frac{S_n - \mathbb E[S_n]}{\sqrt{\operatorname{Var}(S_n)}}$ が従う分布を述べよ。</li>
                </ul>
              </li>
              
              <li><strong>シミュレーション:</strong>
                <ul>
                  <li>$n=60$ として、サイコロを60回投げる試行を10000回繰り返すシミュレーションを実装せよ。</li>
                  <li>得られた $S_n$ の値のヒストグラムを作成せよ。</li>
                  <li>同じグラフ上に、理論的な正規分布の密度関数(平均 $\mathbb E[S_n]$、分散 $\operatorname{Var}(S_n)$)を重ねて描け。</li>
                  <li>連続性補正を適用した正規近似と、適用しない場合の違いを可視化せよ。</li>
                </ul>
              </li>
              
              <li><strong>考察:</strong>
                <ul>
                  <li>シミュレーション結果と正規近似がどの程度一致しているか評価せよ。</li>
                  <li>$n$ の値を変えた場合(例: $n=10, 30, 100$)に正規近似の精度がどう変化するか調べよ。</li>
                  <li>連続性補正の効果について論じよ。</li>
                </ul>
              </li>
            </ol>

            <div class="note">
              <strong>ヒント:</strong> Python, R, MATLAB などのプログラミング言語を使用してよい。
              乱数生成には各言語の標準ライブラリを利用すること。
              グラフは見やすく、軸ラベルや凡例を適切に付けること。
            </div>
          </article>
        </div>
      </section>
    </main>

    <!-- Navigation -->
    <nav class="navigation" aria-label="ページナビゲーション">
      <a href="class5.html" rel="prev">← 前のクラス</a>
      <a href="../index.html">ホーム</a>
      <a href="class7.html" rel="next">次のクラス →</a>
    </nav>

    <footer>
      <p>© 2025 確率論講義 — All rights reserved.</p>
    </footer>
  </div>

  <noscript>
    <p style="text-align:center">数式の表示には JavaScript が必要です(MathJax を読み込んでください)。</p>
  </noscript>
</body>
</html>