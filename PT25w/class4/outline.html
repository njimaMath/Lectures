1. 極限定理

Def: X が可積分 ⇔ E[X_+]<¥infty かつ E[X_-]<¥infty.

確率変数列 (X_n) が X_n:¥Omega→¥R の可測写像であり、可測空間が ¥mathcal{F}_n⊆¥mathcal{F}_{n+1} を満たすとする。 (X_0)_- が可積分ならば、¥E[¥lim X_n]=¥lim ¥E[X_n].

さらに ¥lim X_n = X a.s. かつ |X_n|≤Y を満たす可積分な確率変数 Y が存在するならば、¥E[¥lim X_n]=¥E[X].

例は後で扱う。

2. 有限回の試行

表と裏が同じ確率で出るコインを n 回投げる。この試行を確率空間で定式化する。

¥Omega = ¥{+1,-1}^n,  ¥mathcal{F} = 2^¥Omega,  p_¥omega = 1/2^n.

したがって確率測度は P(A)=¥sum_{¥omega¥in A}p_¥omega=|A|/2^n.

X_i: i 回目が表なら 1、裏なら 0 とする確率変数とおく。

X_i(¥omega)=¥begin{cases} 1 & ¥text{if } ¥omega_i=+1 \\ 0 & ¥text{if } ¥omega_i=-1 ¥end{cases},  S_n=¥sum_{i=1}^n X_i は表が出た回数。

E[S_n]=n/2,  Var(S_n)=n/4.

3. 無限回の試行

無限回コインを投げたい。素朴には n 回の試行を n→¥infty とすれば良さそうに見える。

¥Omega→{+1,-1}^{¥N}、¥mathcal{F}_n→2^{¥Omega}, p_¥omega→0。これはうまくいかない。

そこで ¥Omega={+1,-1}^{¥N} とする。F と P をどのように定義するかを考える。

射影 π_n:¥Omega→¥Omega_n,  π_n(¥omega)=(¥omega_1,¥omega_2,...,¥omega_n).

¥mathcal{F}_n={π_n^{-1}(A) | A⊆¥Omega_n},  ¥forall n∈¥N.

µ(π_n^{-1}(A))=P_n(A),  ¥forall A⊆¥Omega_n.

¥mathcal{S}=¥{A : A∈¥bigcup ¥mathcal{F}_n for some n¥}.

F=σ(¥mathcal{S}),  P(A)=¥inf_{(B_k)∈¥mathcal{S}, A⊆¥cup B}¥sum µ(B_k).

Thm: P は (¥Omega,F) 上の確率測度である。

section 3 / 定理の証明

Step 1.
Lem. 任意の A_n⊆¥Omega について P(¥cup^¥infty A_n)≤¥sum^¥infty P(A_n). In particular, P(A¥setminus B) ¥geq P(A)-P(B)

{Proof.}

ε>0 を与える。各 n について A_n⊆B_n かつ ¥sum P(B_n,k)≤P(A_n)+ε/2^n を満たす (B_n,k)∈¥mathcal{S} が存在する。S=¥cup B_n,k とおくと、¥cup A_k⊆S であり P(¥cup A_k)≤P(S)≤¥sum µ(B_n,k)≤¥sum^¥infty (P(A_k)+ε/2^k)=¥sum^N P(A_k)+ε. ε 任意より主張が従う。

Lem2. For any E¥in ¥kS, P(E)=µ(E).

Proof.
Let S_n in ¥kS  be such that S¥subset ¥cup S_n. We take $E_n = E¥seminut ¥cup^n S_n$. Then, E_n¥in ¥kS and E_n is decreasing. Since E_n is compact, if ¥E_n¥neq empty, ¥cap E_n¥neq ¥emptyset, which derives a contradiction. Hence, E¥subset ¥cup^N S_n with some N. Therefore, ¥sum^N µ(S_n)¥geq mu(E). Taking infimum over all such (S_n), we get P(E)= µ(E). 
Step 2.

補題 1. (カラテオドリの拡張定理)

¥mathcal{F}'=¥{A⊆¥Omega : 任意の ε>0 に対し、ある (B_k),(C_k)∈¥mathcal{S} が存在して P(A△(¥cup B_k))<ε,P(A^c △(¥cup C_k))<ε¥} とする。このとき ¥mathcal{F}⊆¥mathcal{F}'。また ¥mathcal{F}' は σ-下方族であり ¥mathcal{F}⊆¥mathcal{F}'。

Proof:

¥Omega∈¥mathcal{F}' なのは P(¥Omega△¥Omega)=0 より明らか。

A∈¥mathcal{F}' ならば A^c∈¥mathcal{F}'も定義から明らか。

さらに A_n∈¥mathcal{F}' とする。¥eps>0を任意に取る。各 n について P(A_n△B_n),P(A^c_n△C_n)<ε/2^n を満たす B_n∈¥mathcal{S} を取る。A=¥cup A_n,、B= ¥cup B_n, C=¥cup C_n とおく。
P(A¥triangle B)≤¥sum P(A_n△B_n)< ¥eps.
同様にP(A¥triangle C)<¥eps. よって A∈¥mathcal{F}'。 
¥end{proof}

Proof of thm: P(¥Omega)=1、かつ P(A)∈[0,1] は自明。

互いに交わらない A_n∈¥mathcal{F} に対し、P(A:=¥cup A_n)=¥sum P(A_n) を示す。補題より, ¥leqは成り立つ. P(A)¥egq ¥sum P(A_n)を示す.

N¥in ¥Nを一つ固定する. ε>0 を与える。補題より P(A_n△B_n)<ε を満たす B_n を取れる。B_n = ¥cup B_{n,k}ただし(B_{n,k})_kは互いに素とすると, 任意のrについて, ¥sum^r_{k=1} P(B_{n,k}) = P(¥cup^r B_{  n,k}) ¥leq P(B_n). したがって,  ¥sum^¥infty_{k=1} P(B_{n,k})<¥infty. 以上より, あるN_nが存在して, ¥sum_{k>N_n} P(B_{n,k})<ε. Let B_n' = ¥cup^{Nn} B_{n,k}.


一方 P(A)≥P(¥cup_{n=1}^N A_n)≥ P(¥cup B_n') - P(¥cup B_n¥setminus B_n') - ¥sum P(A_n△B_n) ¥geq P(¥cup B_n') - Nε - Nε.

D_n = B_n'¥setminus (¥cup^{n-1}_j B_{j}') とすると,
\begin{equation}\label{eq:incl}
A_n\ \subset\ D_n\ \cup\ (A_n\triangle B_n')\ \cup\ \bigcup_{j=1}^{n-1}(B_j'\triangle A_j).
\end{equation}
Indeed, take $x\in A_n$. If $x\notin B_n'$, then $x\in A_n\setminus B_n'\subset A_n\triangle B_n'$.
If $x\in B_n'$ but $x\notin D_n$, then $x\in B_j'$ for some $j<n$. Since the $A_i$ are pairwise disjoint and $x\in A_n$, we have $x\notin A_j$, hence $x\in B_j'\setminus A_j\subset B_j'\triangle A_j$.
This proves \eqref{eq:incl}. Applying monotonicity and subadditivity of $P$ to \eqref{eq:incl} yields
[
P(A_n)\ \le\ P(D_n)\ +\ P(A_n\triangle B_n')\ +\ \sum_{j=1}^{n-1} P(B_j'\triangle A_j),
]
書き換えると
P(D_n)¥geq P(A_n) - P(A_n ¥triangle B_n') - ¥sum_{j=1}^{n-1}P(B_j'¥triangle A_j) ¥geq P(A_n) - 4 N ¥eps. よって

P(¥cup B_n') = ¥sum P(D_n) ¥geq ¥sum^N P(A_n) - 2 N ¥eps. よって
P(¥cup^N A_n) ¥geq ¥sum^N P(A_n) - 3Nε. ¥epsは任意より

P(¥cup^N A_n) ¥geq ¥sum^N P(A_n). N¥to ¥inftｙとすると, 主張が従う。
