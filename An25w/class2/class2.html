<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>第2回 有理関数の積分</title>
  <style>
      @import url('https://fonts.googleapis.com/css2?family=Cabin:wght@500&family=Noto+Sans+JP:wght@400;500;700&display=swap');

      :root {
          --background: radial-gradient(120% 120% at 20% 20%, #1e3a8a 0%, #0f172a 55%, #020617 100%);
          --card-bg: rgba(255, 255, 255, 0.88);
          --card-border: rgba(255, 255, 255, 0.25);
          --accent: #4c6ef5;
          --accent-soft: rgba(76, 110, 245, 0.14);
          --accent-strong: #2c3791;
          --text-primary: #0f172a;
          --text-secondary: #475569;
          --highlight: #facc15;
          --shadow: 0 18px 45px -25px rgba(15, 23, 42, 0.75);
      }

      *, *::before, *::after {
          box-sizing: border-box;
      }

      body {
          font-family: 'Noto Sans JP', 'Hiragino Sans', 'Meiryo', sans-serif;
          line-height: 1.7;
          margin: 0;
          min-height: 100vh;
          padding: 60px 24px;
          color: var(--text-primary);
          background: var(--background);
          position: relative;
          display: flex;
          justify-content: center;
          align-items: flex-start;
      }

      body::before {
          content: "";
          position: fixed;
          inset: 0;
          background: repeating-linear-gradient(135deg, rgba(255, 255, 255, 0.04) 0, rgba(255, 255, 255, 0.04) 12px, transparent 12px, transparent 24px);
          pointer-events: none;
          z-index: 0;
      }

      main {
          width: min(960px, 100%);
          background: var(--card-bg);
          backdrop-filter: blur(18px);
          border: 1px solid var(--card-border);
          border-radius: 28px;
          padding: 56px 64px;
          position: relative;
          z-index: 1;
          box-shadow: var(--shadow);
      }

      header.hero {
          text-align: center;
          margin-bottom: 48px;
          display: grid;
          gap: 18px;
      }

      .hero-label {
          display: inline-flex;
          align-items: center;
          justify-content: center;
          gap: 8px;
          padding: 6px 16px;
          border-radius: 999px;
          font-size: 14px;
          letter-spacing: 0.08em;
          text-transform: uppercase;
          color: var(--accent-strong);
          background: var(--accent-soft);
          font-family: 'Cabin', sans-serif;
      }

      h1 {
          font-size: clamp(32px, 4vw, 44px);
          margin: 0;
          color: var(--accent-strong);
          letter-spacing: 0.05em;
      }

      header.hero p {
          margin: 0 auto;
          max-width: 620px;
          color: var(--text-secondary);
          font-size: 17px;
      }

      section.outline-section {
          background: rgba(255, 255, 255, 0.78);
          border: 1px solid rgba(148, 163, 184, 0.25);
          padding: 32px 36px;
          border-radius: 22px;
          margin-bottom: 32px;
          box-shadow: 0 24px 40px -32px rgba(15, 23, 42, 0.35);
      }

      section.outline-section:last-of-type {
          margin-bottom: 0;
      }

      h2 {
          display: flex;
          align-items: center;
          gap: 14px;
          font-size: 24px;
          margin: 0 0 24px;
          color: var(--accent-strong);
      }

      h2::before {
          content: "";
          width: 42px;
          height: 4px;
          border-radius: 999px;
          background: linear-gradient(90deg, var(--accent) 0%, rgba(76, 110, 245, 0.2) 100%);
      }

      h3 {
          font-size: 19px;
          margin-top: 28px;
          color: var(--accent-strong);
      }

      p {
          margin: 0 0 16px;
          color: var(--text-secondary);
      }

      ol, ul {
          margin: 0 0 18px;
          padding-left: 24px;
          color: var(--text-secondary);
      }

      .concept-card,
      .theorem,
      .definition,
      .proof,
      .note,
      .example {
          margin: 18px 0;
          padding: 18px 22px;
          border-radius: 18px;
          background: rgba(248, 250, 252, 0.86);
          border: 1px solid rgba(148, 163, 184, 0.25);
          box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.55);
          color: var(--text-secondary);
      }

      .focus-card {
          background: rgba(76, 110, 245, 0.08);
          border: 1px solid rgba(76, 110, 245, 0.22);
          box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.4), 0 20px 32px -28px rgba(76, 110, 245, 0.55);
      }

      .theorem {
          border-left: 6px solid rgba(76, 110, 245, 0.65);
      }

      .definition {
          border-left: 6px solid rgba(34, 197, 94, 0.65);
      }

      .proof {
          border-left: 6px solid rgba(148, 163, 184, 0.65);
      }

      .note {
          border-left: 6px solid rgba(250, 204, 21, 0.7);
          background: rgba(250, 204, 21, 0.08);
      }

      .example {
          border-left: 6px solid rgba(14, 165, 233, 0.7);
          background: rgba(14, 165, 233, 0.08);
      }

      .concept-card strong,
      .theorem strong,
      .definition strong,
      .proof strong,
      .note strong,
      .example strong {
          display: block;
          font-family: 'Cabin', sans-serif;
          font-weight: 600;
          color: var(--accent-strong);
          letter-spacing: 0.04em;
          margin-bottom: 8px;
      }

      .formula {
          background: rgba(76, 110, 245, 0.08);
          padding: 18px;
          border-radius: 16px;
          margin: 18px 0;
          overflow-x: auto;
          text-align: center;
          font-size: 1.05rem;
          font-family: 'Latin Modern Math', 'Cambria Math', serif;
          color: var(--accent-strong);
          border: 1px solid rgba(76, 110, 245, 0.2);
          box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.35);
      }

      table {
          width: 100%;
          border-collapse: collapse;
          margin: 18px 0;
          background: rgba(255, 255, 255, 0.92);
          border-radius: 18px;
          overflow: hidden;
          border: 1px solid rgba(148, 163, 184, 0.3);
          box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.4);
      }

      th, td {
          border-bottom: 1px solid rgba(148, 163, 184, 0.25);
          padding: 12px 16px;
          text-align: center;
          color: var(--text-secondary);
      }

      th {
          background: rgba(76, 110, 245, 0.1);
          font-weight: 600;
          color: var(--accent-strong);
          font-family: 'Cabin', sans-serif;
          letter-spacing: 0.04em;
      }

      tr:last-child td {
          border-bottom: 0;
      }

      .graph {
          text-align: center;
          margin: 24px 0;
      }

      .graph svg {
          max-width: 100%;
          height: auto;
          border-radius: 16px;
          background: rgba(255, 255, 255, 0.92);
          border: 1px solid rgba(148, 163, 184, 0.25);
          box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.4), 0 16px 28px -24px rgba(15, 23, 42, 0.6);
      }

      .exercise-list {
          background: rgba(250, 204, 21, 0.12);
          border: 1px solid rgba(250, 204, 21, 0.32);
          padding: 22px 24px;
          border-radius: 18px;
          margin: 22px 0;
          box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.4);
          color: var(--text-secondary);
      }

      code {
          font-family: 'Source Code Pro', 'Courier New', monospace;
          background: rgba(15, 23, 42, 0.12);
          padding: 2px 6px;
          border-radius: 6px;
          color: var(--accent-strong);
      }

      .nav-buttons {
          display: flex;
          justify-content: center;
          gap: 16px;
          margin-top: 48px;
          padding-top: 32px;
          border-top: 2px solid rgba(148, 163, 184, 0.2);
      }

      .nav-buttons a {
          display: inline-flex;
          align-items: center;
          gap: 8px;
          padding: 12px 24px;
          background: var(--accent);
          color: white;
          text-decoration: none;
          border-radius: 12px;
          font-weight: 600;
          font-family: 'Cabin', sans-serif;
          transition: all 0.3s ease;
          box-shadow: 0 4px 12px rgba(76, 110, 245, 0.3);
      }

      .nav-buttons a:hover {
          background: var(--accent-strong);
          transform: translateY(-2px);
          box-shadow: 0 6px 16px rgba(76, 110, 245, 0.4);
      }

      @media (max-width: 768px) {
          body {
              padding: 32px 16px;
          }

          main {
              padding: 36px 24px;
              border-radius: 22px;
          }

          section.outline-section {
              padding: 28px 24px;
          }

          h2 {
              font-size: 22px;
          }

          h3 {
              font-size: 18px;
          }
      }
  </style>

  <!-- MathJax configuration (uses $...$ and $$...$$) -->
  <script>
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$', '$$'], ['\\[', '\\]']],
      processEscapes: true,
      processEnvironments: true
    },
    options: {
      skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code', 'svg', 'math'],
      ignoreHtmlClass: 'no-mathjax',
      processHtmlClass: 'mathjax-process'
    }
  };
  </script>
  <script id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
  <main>
    <header class="hero">
      <span class="hero-label">Lecture 2</span>
      <h1>第2回 有理関数の積分</h1>
      <p>基本形の積分公式と部分分数分解をまとめ，有理関数の積分を体系的に扱う。</p>
    </header>

    <section class="outline-section">
      <h2>1. 有理関数の定義</h2>
      <div class="definition">
        <strong>定義（多項式・有理関数）</strong>
        <p>$a_n, \dots, a_0 \in \mathbb{R}$ として $f(x) = a_n x^n + \cdots + a_1 x + a_0$ を<strong>多項式</strong>という。
        多項式 $P, Q$ を用い $f(x) = \dfrac{P(x)}{Q(x)}$ と表せるものを<strong>有理関数</strong>と呼ぶ。</p>
      </div>
    </section>

    <section class="outline-section">
      <h2>2. 基礎的な有理関数の積分</h2>
      <h3>□ $\dfrac{1}{(x-\alpha)^n}$ の積分（$n\in\mathbb{N}$）</h3>
      <div class="formula">
        $$\int (x-\alpha)^{-n}dx = 
          \begin{cases}
            \dfrac{(x-\alpha)^{1-n}}{1-n}+C, & n\neq1,\\[6pt]
            \log|x-\alpha|+C, & n=1.
          \end{cases}$$
      </div>

      <h3>□ $\dfrac{1}{x^2+ax+b}$ の積分</h3>
      <p>判別式 $D=a^2-4b$ で場合分けする。</p>

      <div class="formula">
        $$\int \frac{dx}{x^2+ax+b} = 
        \begin{cases}
          \dfrac{1}{\alpha-\beta}\log\!\left|\dfrac{x-\alpha}{x-\beta}\right|+C, & D>0,\\[6pt]
          -\dfrac{1}{x+\frac{a}{2}}+C, & D=0,\\[6pt]
          \dfrac{2}{\sqrt{4b-a^2}}\arctan\!\left(\dfrac{2x+a}{\sqrt{4b-a^2}}\right)+C, & D<0.
        \end{cases}$$
      </div>
      <p>ここで $D>0$ のとき $\alpha,\beta$ は二次式 $x^2+ax+b=(x-\alpha)(x-\beta)$ の実根である。$D<0$ のときは $\Delta:=4b-a^2=-D>0$ とおくと $x^2+ax+b=\left(x+\tfrac{a}{2}\right)^2+\tfrac{\Delta}{4}$ より上式が得られる。</p>
    </section>
<section class="outline-section">
  <h3>□ $\dfrac{1}{(x^2+1)^n}$ の積分（帰納公式）</h3>
  <p>$I_n(x):=\displaystyle\int \dfrac{dx}{(x^2+1)^n}$ とおく。$I_1(x)=\arctan x$。$n\ge2$ については部分積分（または $\dfrac{d}{dx}\!\left[\dfrac{x}{(x^2+1)^{\,n-1}}\right]$ の計算）から次の帰納式が得られる。</p>
  <div class="formula">
    $$I_n(x)=\frac{x}{2(n-1)(x^2+1)^{\,n-1}}+\frac{2n-3}{2(n-1)}\,I_{n-1}(x)\qquad(n\ge2).$$
  </div>
  <p>この式を繰り返し適用すると、$I_n(x)$ は $\arctan x$ と $\dfrac{x}{(x^2+1)^k}$（$1\le k\le n-1$）の線形結合として表せる。</p>

<h3>□ 応用：$\dfrac{cx+d}{(x^2+ax+b)^n}$ の積分（$D=a^2-4b<0$）</h3>
<p>$t:=\dfrac{x+\frac{a}{2}}{\sqrt{b-(a/2)^2}}$ とおくと、$x^2+ax+b=(b-(a/2)^2)(t^2+1)$ である。分子を $\sqrt{b-(a/2)^2}\,ct+\bigl(d-\dfrac{ac}{2}\bigr)$と書くと、</p>
<div class="formula">
  $$\int \frac{cx+d}{(x^2+ax+b)^n}\,dx
  =c\,(b-(a/2)^2)^{1-n}\!\int\frac{t}{(t^2+1)^n}\,dt$$
    $$
  +\left(d-\frac{ac}{2}\right)(b-(a/2)^2)^{\frac12-n}\!\int\frac{dt}{(t^2+1)^n}.$$
</div>
  <p>右辺第一項は置換 $w=t^2+1$ で</p>
<div class="formula">
  $$\int\frac{t}{(t^2+1)^n}\,dt
  =-\frac{1}{2(n-1)}(t^2+1)^{1-n}+C.$$
</div>
  <p>第二項は$I_n(t)=\displaystyle\int\dfrac{dt}{(t^2+1)^n}$ に帰着する。</p>

</section>

    <section class="outline-section">
      <h2>3. 一般の有理関数の積分</h2>
      <p>部分分数分解によりすべての有理関数の積分を求められる。</p>
      <div class="theorem">
        <strong>定理（部分分数分解）</strong>
        <p>任意の有理関数 $\dfrac{P(x)}{Q(x)}$ は
        $$\sum_{i,m}\frac{C_{i,m}}{(x-\alpha_i)^m}
          +\sum_{j,m}\frac{D_{j,m}x+E_{j,m}}{(x^2+a_jx+b_j)^m}$$
        に一意的に分解できる。</p>
      </div>
    </section>

    <div class="nav-buttons">
      <a href="../class1/class1.html">← Previous</a>
      <a href="../index.html">🏠 Home</a>
      <a href="../class3/class3.html">Next →</a>
    </div>
  </main>
</body>
</html>
